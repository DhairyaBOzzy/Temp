# BAPSÂ ColumbusÂ RegistrationÂ Portal

<p align="center">
  <img src="/public/baps-logo.svg" alt="BAPSÂ Columbus" height="110"/>
</p>

A **ViteÂ +Â ReactÂ (TypeScript)** singleâ€‘page application for collecting and managing member registrations at BAPS Columbus Mandir. The form dynamically adapts to household composition, performs strong clientâ€‘side validation, blocks duplicates & spam with Firestore queries, and persists everything securely in **Firebase CloudÂ Firestore**.

---

## âœ¨Â KeyÂ Features

|Â DomainÂ |Â Details |
|--------|---------|
| **Dynamic UI** | Spouse panel appears when *Marital StatusÂ =Â Married* Â· Children panel can addÂ â‰¤Â 4 children with table preview & row delete |
| **Validation & Formatting** | Live regex checks for email Â· Phone autoâ€‘formats *(###)Â ###â€‘####* and enforces 10 digits Â· 5â€‘digit ZIP filter |
| **Data Integrity** | Composite index driven **duplicate** checks onÂ `primaryMember.email` & `primaryMember.phone` Â· **Rateâ€‘limit**Â =Â 5Â min between submissions per email |
| **Resilience** | Toast notifications for every success/error Â· Graceful Firestore error handling |
| **Developer UX** | Absolute imports via `@/` alias Â· ESLintÂ +Â Prettier + Husky preâ€‘commit Â· TailwindÂ CSS with shadcn/ui and Radix primitives |
| **Deploy Anywhere** | Vite `base:""` ready for FirebaseÂ Hosting, Vercel, Netlify |

---

## ğŸ—‚Â ProjectÂ Structure

```
ğŸ“¦baps-registration
â”œâ”€ .env.example              # copy -> .env for local secrets
â”œâ”€ package.json              # scripts & dependencies (see below)
â”œâ”€ vite.config.ts            # aliasÂ @ â†’ src/, base="" for hosting
â”œâ”€ tsconfig.json             # paths config
â”œâ”€ firebase.json             # hosting + emulators
â”œâ”€ firestore.rules           # *publicâ€‘read, createâ€‘only* rules
â”œâ”€ firestore.indexes.json    # composite index for duplicate & rateâ€‘limit queries
â”œâ”€ public/
â”‚Â Â  â”œâ”€ baps-logo.svg         # production logo
â”‚Â Â  â””â”€ index.html
â””â”€ src/
    â”œâ”€ firebase.ts           # initialiseAppÂ + getFirestore
    â”œâ”€ pages/Index.tsx       # main wizard + submit logic
    â”œâ”€ components/
    â”‚Â Â  â”œâ”€ PrimaryMemberForm.tsx
    â”‚Â Â  â”œâ”€ SpouseForm.tsx
    â”‚Â Â  â”œâ”€ ChildrenForm.tsx
    â”‚Â Â  â”œâ”€ FormSummary.tsx
    â”‚Â Â  â””â”€ ui/â€¦ (shadcn reâ€‘exports)
    â””â”€ styles/tailwind.css
```

---

## ğŸ”§Â Prerequisites

| Requirement | Version |
|-------------|---------|
| **NodeÂ JS** | â‰¥Â 18.x |
| **pnpm / npm / yarn** | latest |
| **Firebase CLI** | `npmÂ iÂ -gÂ firebase-tools` |

---

## ğŸ“¦Â Dependencies Snapshot

> For the full list open *package.json*, but highlights include:

* **reactÂ 18**, **@vitejs/plugin-react-swc** â€“ superâ€‘fast dev/TSX build
* **tailwindcssÂ 3** + **tailwindcss-animate** + **clsx** + **classâ€‘varianceâ€‘authority**
* **RadixÂ UI** + **shadcn/ui** components used throughout
* **firebaseÂ 11.6** â€“ Firestore client
* **lucideâ€‘react**, **sonner (toast)**, **zod** (future schema validation)

---

## ğŸ› Â NPMÂ Scripts

| Script | Purpose |
|--------|---------|
| `pnpmÂ dev` | Launch Vite dev server on <http://localhost:8080> |
| `pnpmÂ build` | Production build to `dist/` |
| `pnpmÂ build:dev` | *Debug* build without minification |
| `pnpmÂ preview` | Serve the production bundle locally |
| `pnpmÂ lint` | ESLint + Prettier checks |

---

## ğŸ”Â EnvironmentÂ Variables (`.env`)

```
VITE_FIREBASE_API_KEY="â€¦"
VITE_FIREBASE_AUTH_DOMAIN="â€¦"
VITE_FIREBASE_PROJECT_ID="â€¦"
VITE_FIREBASE_STORAGE_BUCKET="â€¦"
VITE_FIREBASE_MESSAGING_SENDER_ID="â€¦"
VITE_FIREBASE_APP_ID="â€¦"
```
> **Never commit** real keys â€“ use `.env.local` in CI.

---

## ğŸ”’Â FirestoreÂ SecurityÂ Rules (`firestore.rules`)

```firestore
service cloud.firestore {
  match /databases/{db}/documents {
    // Registrations collection is *appendâ€‘only*
    match /registrations/{id} {
      allow create: if true;      // anyone can submit
      allow read, list: if true;  // anyone can view (adjust as needed)
      allow update, delete: if false;
    }
    match /{document=**} {
      allow read, write: if false; // deny everything else
    }
  }
}
```
> Tighten reads with auth / custom claims when ready.

---

## ğŸ—„Â CompositeÂ Index

The duplicate & recentâ€‘submission queries require:

```jsonc
{
  "collectionGroup":"registrations",
  "fields":[
    {"fieldPath":"primaryMember.email","order":"ASCENDING"},
    {"fieldPath":"submittedAt","order":"DESCENDING"}
  ]
}
```
Create automatically via the link in the Firebase error dialog, or import `firestore.indexes.json` in the console.

---

## ğŸ§ªÂ FormÂ LogicÂ &Â Validation

### Primary Member
* Mandatory fields: first/last name, address, city, state, zip (5), email, phone (10), gender, maritalStatus
* Email regex, phone formatter, zip filter built into **`handleChange`** in `PrimaryMemberForm.tsx`

### Spouse
* Shown only when maritalStatusÂ =Â *Married*
* First & last name required; email & phone optional but validated if filled

### Children (â‰¤Â 4)
* Each child requires first/last name, gender, full DOB (day/month/year)
* Optional email per child
* Table summary + row deletion with `<Trash2/>`

### Submission Flow (`Index.tsx`)
1. **validateForm()** guards required fields.
2. Duplicateâ€emailÂ query â” toast error.
3. Duplicateâ€phoneÂ query â” toast error.
4. *Rateâ€‘limit* query on `submittedAt` within last 5Â min.
5. If all clear: `addDoc()` to `registrations` and show `<FormSummary/>`.

---

## ğŸš€Â LocalÂ DevÂ &Â Emulators

```bash
# serve + hotâ€‘reload
pnpm dev

# optionally spin up Firestore emulator (portÂ 8080)
firebase emulators:start --only firestore
```
*The Vite dev server uses portÂ 8080 to avoid clash with the emulator.* Adjust in `vite.config.ts` if you change emulator ports.

---

## ğŸ—Â Deployment

### FirebaseÂ Hosting

```bash
firebase login
firebase init hosting  # choose dist/ as publicDir
pnpm build
firebase deploy
```

### Vercel / Netlify
* Just add the same **env vars** in project settings.
* Build command: `pnpm build`, output: `dist/` (detected automatically).

---


## ğŸªªÂ License

MITÂ Â©Â 2025Â BAPSÂ Columbus,Â OH

